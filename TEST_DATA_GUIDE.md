# 测试数据说明

本文档介绍系统初始化时创建的测试数据。

## 测试数据概览

系统首次启动时会自动初始化以下测试数据：

### 1. 管理员账户

| 字段 | 值 |
|------|-----|
| 用户名 | admin |
| 密码 | admin123 |
| 邮箱 | admin@example.com |
| 角色 | admin |

**⚠️ 安全提示：部署后请立即修改默认密码！**

---

### 2. 系统设置

系统初始化时会创建以下系统设置：

**网站信息：**
- 网站名称：日用产品批发零售系统
- 网站标题：日用产品批发零售系统

**公司信息：**
- 公司名称：日用产品批发零售系统
- 联系电话：400-888-8888
- 联系邮箱：service@example.com
- 公司地址：北京市朝阳区XXX街道XXX号

**版权与备案：**
- 版权信息：© 2024 日用产品批发零售系统. All rights reserved.
- ICP备案号：京ICP备XXXXXXXX号

**通知设置：**
- 邮件通知：未启用
- 短信通知：未启用

---

### 3. 产品分类（5个）

| ID | 分类名称 | 描述 |
|----|----------|------|
| 1 | 个人护理 | 牙膏、洗发水、沐浴露等个人护理用品 |
| 2 | 清洁用品 | 洗衣液、洗洁精、清洁剂等清洁用品 |
| 3 | 纸品湿巾 | 卫生纸、抽纸、湿巾等纸品 |
| 4 | 厨房用品 | 保鲜膜、垃圾袋等厨房用品 |
| 5 | 家居纺织 | 毛巾、浴巾、床上用品等 |

---

### 4. 测试产品（15个）

所有产品都配有来自Unsplash的高质量网络图片。

#### 个人护理类

| 货号 | 产品名称 | 规格 | 零售价 | 批发价 | 批发起订量 | 库存 | 图片数 |
|------|----------|------|--------|--------|-----------|------|--------|
| SP001 | 牙膏-薄荷味 | 120g | ¥12.5 | ¥10.0 | 2支 | 500 | 2张 |
| SP002 | 洗发水-去屑型 | 400ml | ¥38.0 | ¥32.0 | 3瓶 | 200 | 2张 |
| SP006 | 沐浴露-海洋香 | 750ml | ¥45.0 | ¥38.0 | 3瓶 | 150 | 2张 |
| SP010 | 护手霜-滋润型 | 50g | ¥22.0 | ¥18.0 | 5支 | 250 | 2张 |
| SP015 | 洗手液-芦荟 | 500ml | ¥18.0 | ¥15.0 | 5瓶 | 350 | 2张 |

#### 清洁用品类

| 货号 | 产品名称 | 规格 | 零售价 | 批发价 | 批发起订量 | 库存 | 图片数 |
|------|----------|------|--------|--------|-----------|------|--------|
| SP003 | 洗衣液-薰衣草 | 2L | ¥25.0 | ¥20.0 | 5瓶 | 300 | 1张 |
| SP007 | 洗洁精-柠檬 | 1.5kg | ¥18.0 | ¥15.0 | 5瓶 | 400 | 1张 |
| SP013 | 洗衣粉-强效去污 | 2kg | ¥22.0 | ¥18.0 | 5袋 | 300 | 1张 |

#### 纸品湿巾类

| 货号 | 产品名称 | 规格 | 零售价 | 批发价 | 批发起订量 | 库存 | 图片数 |
|------|----------|------|--------|--------|-----------|------|--------|
| SP005 | 纸巾-抽纸-3层 | 120抽x3包 | ¥12.0 | ¥10.0 | 2提 | 500 | 1张 |
| SP008 | 卫生纸-卷纸 | 140gx10卷 | ¥28.0 | ¥24.0 | 3提 | 350 | 2张 |
| SP011 | 面巾纸-小包 | 10包x8片 | ¥15.0 | ¥12.5 | 5盒 | 400 | 1张 |
| SP012 | 湿巾-婴儿专用 | 80抽x3包 | ¥35.0 | ¥30.0 | 3提 | 200 | 2张 |

#### 厨房用品类

| 货号 | 产品名称 | 规格 | 零售价 | 批发价 | 批发起订量 | 库存 | 图片数 |
|------|----------|------|--------|--------|-----------|------|--------|
| SP009 | 垃圾袋-大号 | 50x60cm | ¥15.0 | ¥12.0 | 10卷 | 500 | 1张 |

#### 家居纺织类

| 货号 | 产品名称 | 规格 | 零售价 | 批发价 | 批发起订量 | 库存 | 图片数 |
|------|----------|------|--------|--------|-----------|------|--------|
| SP004 | 毛巾-纯棉 | 30x70cm | ¥8.5 | ¥7.0 | 10条 | 600 | 2张 |
| SP014 | 浴巾-超柔 | 70x140cm | ¥28.0 | ¥24.0 | 5条 | 200 | 2张 |

**图片说明：**
- 所有产品图片使用来自Unsplash的网络图片URL
- 图片尺寸：400x400像素
- 图片格式：JPG
- 图片来源：免费商用图片，无需授权

---

### 5. 测试订单（4个）

系统创建4个不同状态的订单，用于测试订单管理功能。

| 订单号 | 客户 | 电话 | 邮箱 | 地址 | 状态 | 商品数 | 总金额 | 创建时间 |
|--------|------|------|------|------|------|--------|--------|----------|
| ORD...001 | 张三 | 13800138001 | zhangsan@example.com | 北京市朝阳区建国路88号 | 已完成 | 3件 | ¥88.00 | 5天前 |
| ORD...002 | 李四 | 13900139002 | lisi@example.com | 上海市浦东新区陆家嘴环路1000号 | 已发货 | 2件 | ¥170.00 | 3天前 |
| ORD...003 | 王五 | 13700137003 | wangwu@example.com | 广州市天河区珠江新城华夏路16号 | 已确认 | 2件 | ¥80.00 | 1天前 |
| ORD...004 | 赵六 | 13600136004 | zhaoliu@example.com | 深圳市南山区科技园南区粤海街道 | 待处理 | 3件 | ¥100.50 | 今天 |

**订单详情示例（订单001）：**
- 商品：
  - 牙膏-薄荷味 x2支 = ¥20.00（批发价）
  - 洗发水-去屑型 x1瓶 = ¥38.00（零售价）
  - 纸巾-抽纸-3层 x3提 = ¥30.00（批发价）
- 总金额：¥88.00
- 备注：请加急发货

---

## 测试数据用途

### 1. 功能测试

使用测试数据可以测试以下功能：

- ✅ 产品搜索（按名称、货号、条码）
- ✅ 分类筛选
- ✅ 产品详情查看（包括多图片轮播）
- ✅ 购物车功能
- ✅ 订单创建（自动计算批发价和零售价）
- ✅ 订单管理（查看、确认、发货、完成订单）
- ✅ 数据统计（销售额、订单数量等）
- ✅ 图片管理（多图片上传、排序、删除）

### 2. UI/UX测试

测试数据涵盖：
- 不同长度的产品名称
- 不同格式的规格说明
- 不同数量的商品（单商品、多商品订单）
- 不同状态的订单
- 多图片产品
- 不同价格区间的产品

---

## 重新初始化数据

### 方法1：删除数据库文件（开发环境）

```bash
# 停止应用
# 删除数据库
rm instance/price_query.db

# 重启应用，会自动初始化
python -m flask run --port=5000
```

### 方法2：使用初始化脚本

```bash
# 重新初始化所有数据
python scripts/init_data.py --force
```

### 方法3：手动删除数据

```python
from app import create_app, db
from app.models import User, Product, Order, Category, SystemSetting, ProductImage, OrderItem

app = create_app()

with app.app_context():
    OrderItem.query.delete()
    Order.query.delete()
    ProductImage.query.delete()
    Product.query.delete()
    Category.query.delete()
    SystemSetting.query.delete()

    db.session.commit()
```

---

## 扩展测试数据

### 添加更多测试产品

编辑 `app/services/init_service.py` 文件，在 `products_data` 列表中添加新产品：

```python
{
    'product_code': 'SP016',
    'barcode': '6901234567905',
    'name': '新产品名称',
    'model': 'Model-16001',
    'specification': '规格说明',
    'unit': '单位',
    'retail_price': 10.0,
    'wholesale_price': 8.0,
    'wholesale_min_qty': 5,
    'stock': 100,
    'description': '产品描述',
    'category': '分类名称',
    'images': [
        'https://images.unsplash.com/photo-xxx?w=400&h=400&fit=crop'
    ]
},
```

### 添加更多测试订单

编辑 `app/services/init_service.py` 文件，在 `orders_data` 列表中添加新订单：

```python
{
    'customer_name': '客户姓名',
    'customer_phone': '13800138005',
    'customer_email': 'customer@example.com',
    'customer_address': '客户地址',
    'status': 'pending',
    'items': [
        {'product': products[0], 'quantity': 2},
        {'product': products[1], 'quantity': 3},
    ],
    'notes': '订单备注',
    'created_at': datetime.utcnow()
},
```

---

## 生产环境建议

### 1. 删除测试数据

生产环境部署时，建议：

1. 使用空数据库，不初始化测试数据
2. 或初始化后手动删除测试数据
3. 从生产数据库导入真实数据

### 2. 修改管理员密码

```bash
python -c "
from app import create_app, db
from app.models import User

app = create_app()
with app.app_context():
    admin = User.query.filter_by(username='admin').first()
    admin.set_password('new_strong_password')
    db.session.commit()
"
```

或在后台管理界面修改。

### 3. 更新系统设置

访问 `/admin/settings` 更新真实的公司信息：
- 公司名称
- 联系电话
- 联系邮箱
- 公司地址
- 版权信息
- ICP备案号

### 4. 配置通知服务

访问 `/admin/notification-test` 测试并配置：
- 邮件通知
- 短信通知

---

## 常见问题

### Q: 测试图片无法显示怎么办？

A: 检查以下几点：
1. 确认网络连接正常（使用的是Unsplash网络图片）
2. 如果无法访问外网，可以在产品管理中上传本地图片
3. 或使用占位图片（`app/static/images/product-placeholder.jpg`）

### Q: 如何使用自定义图片？

A:
1. 将图片文件放到 `app/static/uploads/products/` 目录
2. 在产品管理中，使用"网络图片"功能，填写本地图片URL
3. 或直接上传本地图片文件

### Q: 为什么有些产品有2张图片？

A: 为了测试产品多图片功能，部分产品配置了2张图片，可以在产品详情页面查看图片轮播效果。

### Q: 测试订单的价格是如何计算的？

A:
- 如果购买数量 >= 批发起订量，使用批发价
- 如果购买数量 < 批发起订量，使用零售价

示例：
- 产品SP001牙膏：零售价¥12.5，批发价¥10.0，批发起订量2支
- 购买2支：使用批发价，¥10.0 × 2 = ¥20.0
- 购买1支：使用零售价，¥12.5 × 1 = ¥12.5

---

## 技术细节

### 初始化流程

系统启动时，`app/__init__.py` 会调用 `init_sample_data()` 函数：

```
create_app()
  └─ db.create_all()
     └─ init_sample_data()
        ├─ create_default_admin()
        ├─ create_default_settings()
        ├─ create_sample_categories()
        ├─ create_sample_products()
        └─ create_sample_orders()
```

### 数据库位置

- 开发环境：`instance/price_query.db`（SQLite）
- 生产环境：PostgreSQL数据库（通过`DATABASE_URL`配置）

### 图片URL格式

网络图片使用Unsplash源：
```
https://images.unsplash.com/photo-<photo-id>?w=400&h=400&fit=crop
```

参数说明：
- `photo-id`: Unsplash照片ID
- `w=400`: 图片宽度
- `h=400`: 图片高度
- `fit=crop`: 裁剪模式

---

## 相关文档

- [部署与初始化指南](DEPLOYMENT_INIT_GUIDE.md)
- [通知配置指南](NOTIFICATION_CONFIG_GUIDE.md)
- [项目README](README.md)
